import{a as U}from"./chunk-FJTDMGYD.js";import{a as H}from"./chunk-F2AWUHRW.js";import{a as N}from"./chunk-6ZT7OVEF.js";import{a as O,c as A}from"./chunk-5DBK4ZXR.js";import{e as k}from"./chunk-7IPKTMG7.js";import{$ as F}from"./chunk-FLJC444F.js";import{e as p}from"./chunk-IPZIKDLO.js";import{p as j}from"./chunk-TBJJFKUM.js";import{Fc as E,Gb as l,Qb as d,Rb as s,Sb as m,Wb as _,Yb as x,Z as b,Zb as f,a as c,ad as T,b as g,dc as D,ec as w,fc as B,g as u,ib as n,jc as I,kd as R,lc as M,m as v,nb as o,qa as C,ra as y,ub as S,zb as P}from"./chunk-4KZPWME3.js";function L(r,i){r&1&&(d(0,"div"),m(1,"app-skeleton-loader",2),s())}function V(r,i){if(r&1){let e=_();d(0,"div",3)(1,"app-dynamic-form",4),x("formSubmit",function(a){C(e);let h=f();return y(h.onSave(a))}),d(2,"div",5)(3,"div",6)(4,"h1",7),I(5),s(),m(6,"back-button",8),s()(),m(7,"div",9),s()()}if(r&2){let e=f();n(),l("fields",e.fields)("columns",e.createcolumns)("showcancelbutton",!1)("showcancelbutton",!1)("additionalTest",!0),n(4),M(" ",e.typeMode==="edit"?"Edit Page":"Create Page"," "),n(),l("url",e.rolelistUrl)}}var G=class r{constructor(i,e,t,a,h){this.pageBuilderService=i;this.commonStoreService=e;this.cdr=t;this.toasterService=a;this.router=h}child;destroySubject=new v;typeMode;rolelistUrl=p.MANAGE_CUSTOM_PAGE;createcolumns;fields=[{type:"text",label:"Title",name:"Title",placeholder:"Enter Title",value:"",wrapperClass:"col-md-4",id:"title",changedField:"Route",validators:{required:!0}},{type:"select",label:"Navigation Menu",name:"ParentId",bindLabel:"Title",bindValue:"MenuId",value:"",options:[],id:"ParentId",wrapperClass:"col-12 col-md-4",placeholder:"Select Navigation Menu",groupBy:"child"},{type:"text",label:"Slug",name:"Route",placeholder:"Enter Slug",value:"",wrapperClass:"col-md-4",id:"page-slug",validators:{required:!0}},{type:"pagebuilder",label:"Content",id:"pagebuilder",required:!0,name:"PageBuilder",value:"",validators:{pagebuilder:!0}}];pageDetails;pageConfig;ngOnInit(){return u(this,null,function*(){this.getConfig(),this.pageConfig=yield this.commonStoreService.getFormConfig(),this.typeMode=this.pageConfig.mode})}getConfig(){return u(this,null,function*(){this.pageConfig=yield this.commonStoreService.getFormConfig(),this.pageConfig.id?this.getPageDetails(this.pageConfig.id):this.getPageData(),this.getMenuList()})}getPageData(){this.pageBuilderService.getPage().pipe(b(this.destroySubject)).subscribe({next:i=>{this.pageDetails=i},error:i=>{}})}ngOnDestroy(){this.destroySubject.next(),this.destroySubject.complete()}getPageDetails(i){this.pageBuilderService.getPageDetails(i).subscribe({next:e=>{this.pageDetails={Html:e.data.Html||"",Css:"",Title:e.data.Title||"",id:4,Route:e.data.Route||"",ParentId:e.data.ParentId||""},this.cdr.markForCheck()},error:e=>{}})}onSave(i){let e={Title:i.Title,Portal:4,Route:i.Route,ParentId:i.ParentId,Html:i.PageBuilder,Css:"",Status:i.status};this.pageConfig.id?this.pageBuilderService.updatePage(e,this.pageConfig.id).subscribe({next:t=>{this.toasterService.success(t.message),this.router.navigate([p.MANAGE_CUSTOM_PAGE])},error:t=>{}}):this.pageBuilderService.addPage(e).subscribe({next:t=>{this.pageConfig=g(c({},this.pageConfig),{id:t.data.MenuId}),this.commonStoreService.setFormConfig(this.pageConfig),this.toasterService.success(t.message),this.router.navigate([p.MANAGE_CUSTOM_PAGE])},error:t=>{}})}getMenuList(){this.pageBuilderService.getMenuList(4).pipe().subscribe(i=>{let e=this.fields.find(t=>t.label==="Navigation Menu");e&&(e.options=i.map(t=>g(c({},t),{child:[t,...t.child]}))),this.fields.forEach(t=>{t.name=="PageBuilder"?t.value=this.pageDetails.Html:this.pageDetails[t.name]&&(t.value=this.pageDetails[t.name])}),this.fields=[...this.fields],this.createcolumns=[{value:this.fields}],this.cdr.markForCheck()})}static \u0275fac=function(e){return new(e||r)(o(k),o(U),o(E),o(F),o(j))};static \u0275cmp=S({type:r,selectors:[["app-page-builder"]],viewQuery:function(e,t){if(e&1&&D(O,5),e&2){let a;w(a=B())&&(t.child=a.first)}},decls:2,vars:2,consts:[[4,"ngIf"],["class","builder-header",4,"ngIf"],["type","page-builder"],[1,"builder-header"],["submitButtonText","Save",3,"formSubmit","fields","columns","showcancelbutton","additionalTest"],["page-builder",""],[1,"d-flex","flex-row-reverse","align-items-center"],[1,"rd-heading","rd-heading-lg"],[3,"url"],["page-builder-button",""]],template:function(e,t){e&1&&P(0,L,2,0,"div",0)(1,V,8,7,"div",1),e&2&&(l("ngIf",!t.createcolumns),n(),l("ngIf",t.createcolumns))},dependencies:[A,R,T,H,N],styles:[".rd-container-header[_ngcontent-%COMP%]{height:70px;align-items:center;margin:0}.builder-container[_ngcontent-%COMP%]{height:calc(100% - 70px)!important}.title-loader[_ngcontent-%COMP%]{width:350px}  .gjs-field-download{background-color:transparent!important}  .gjs-field-downloadattribute{background-color:transparent!important}  .custom-preview-icon:before{font-family:FontAwesome}  .builder-header .form-container{width:100%!important;margin:0!important;max-width:100%!important;border:none!important;padding:0!important;margin-bottom:2rem!important;display:flex!important;flex-direction:column-reverse!important}  .builder-header .form-container .rd-form-footer{margin-top:0!important;border:none!important;justify-content:end!important;padding-top:0!important;padding-bottom:0!important;justify-content:space-between!important;margin-bottom:1.5rem!important}  .builder-header .form-container .col-12.col-md-12{display:flex;flex-direction:column-reverse}"]})};export{G as a};
