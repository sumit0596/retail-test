import{a as V}from"./chunk-B2JWDLBT.js";import{a as U}from"./chunk-FJTDMGYD.js";import{a as F}from"./chunk-F2AWUHRW.js";import{a as B}from"./chunk-6ZT7OVEF.js";import{e as O}from"./chunk-7IPKTMG7.js";import"./chunk-FQU4EXR4.js";import"./chunk-7GNHLM6X.js";import{Z as x,ba as L}from"./chunk-FLJC444F.js";import{e as _,h as c,k as g,l as N,q as m}from"./chunk-IPZIKDLO.js";import{n as k,p as R}from"./chunk-TBJJFKUM.js";import{Fc as w,Gb as b,Qb as p,Rb as s,Sb as v,Wb as T,Yb as E,Zb as l,a as f,ad as A,b as C,g as I,ib as h,jc as P,kd as M,nb as n,qa as d,ra as u,ub as D,zb as y}from"./chunk-4KZPWME3.js";function z(r,e){if(r&1){let t=T();p(0,"div",7)(1,"div",7)(2,"button",8),E("click",function(){d(t);let i=l();return u(i.createPage())}),P(3," Create New Page "),s()()()}}function H(r,e){if(r&1){let t=T();p(0,"div")(1,"app-datatable",9),E("filterChanged",function(i){d(t);let o=l();return u(o.filterColumns(i))})("rowClicked",function(i){d(t);let o=l();return u(o.rowClicked(i))})("getTableData",function(i){d(t);let o=l();return u(o.tableData(i))})("rowBasedAction",function(i){d(t);let o=l();return u(o.rowActions(i))})("toolbarEvent",function(i){d(t);let o=l();return u(o.onToolbarClick(i))}),s()()}if(r&2){let t=l();h(),b("tableSettings",t.tableConfig)("columns",t.columns)("data",t.pageDetails)("totalCount",t.totalCount)}}function X(r,e){r&1&&(p(0,"div"),v(1,"app-skeleton-loader",10),s())}var S=class r{constructor(e,t,a,i,o,J,K){this.router=e;this.dialog=t;this.route=a;this.commonService=i;this.pageBuilderService=o;this.commonStoreService=J;this.cdr=K}portalUrl;pageDetails;portalId;filterData;tableConfig;filter={PageNo:1,PerPage:10,Search:void 0,SortBy:void 0,SortOrder:"Desc",Status:void 0,Portal:4};totalCount;filterColumns;backUrl=_.ALL_USERS;filteredColumns;access;columns=[];users=[];ngOnInit(){this.route.url.subscribe(e=>{this.portalUrl=this.router.url.replace(e[e.length-1].path,"")}),this.route.parent?.data.subscribe(e=>{this.portalId=e.id||0,this.filter=C(f({},this.filter),{Portal:4})}),this.initializeTable(),this.getColumns()}getColumns(){this.columns=[{key:"Title",title:"Page Name",sortable:!0,visible:!0,showColumn:!0},{key:"CreatedOn",title:"Date Created",sortable:!0,visible:!0,showColumn:!0},{key:"UpdatedOn",title:"Last Edited",sortable:!0,visible:!0,showColumn:!0},{key:"AddedBy",title:"Edited By",sortable:!0,visible:!0,showColumn:!0},{key:"Status",title:"Status",sortable:!1,visible:!0,showColumn:!0},{key:"actions",title:"Actions",sortable:!1,visible:!0,showColumn:!0}],this.initializeTable(),this.cdr.markForCheck(),this.loadTableData(this.filter)}rowClicked(e){}loadTableData(e){this.pageBuilderService.getPageList(e).subscribe({next:t=>{this.pageDetails=t,this.totalCount=t.totalCount,this.formatGridData(t)},error:t=>{}})}tableData(e){this.filter={PageNo:e.pageNumber,PerPage:e.pageSize,Search:e.searchValue,SortBy:e.sortBy??void 0,SortOrder:e.sortOrder??void 0,Status:e.Status??void 0,Portal:4},this.loadTableData(this.filter)}formatGridData(e){if(this.access=e?.FullAccess,this.tableConfig=C(f({},this.tableConfig),{totalRowsCount:e.totalCount,pageCnt:e.pageCount,tools:[{name:"Search",id:"search",disabled:!1,icon:"assets/images/search.svg"}]}),e?.FullAccess===1)e?.menus.forEach(a=>{a.operations=[{name:m.EDIT_OPERATION,icon:m.EDIT,operationName:m.EDIT,path:"assets/images/edit.svg"},{name:c.DUPLICATE.TITLE,icon:c.DUPLICATE.ICON,operationName:c.DUPLICATE.ID,path:c.DUPLICATE.ICON},{name:m.DELETE,icon:m.DELETE_ICON,operationName:m.DELETE,path:"assets/images/delete.svg"}]});else{var t=this.columns.findIndex(function(a){return a.field=="actions"});t!==-1&&this.columns.splice(t,1)}this.tableConfig.rows=e.menus,this.cdr.markForCheck()}initializeTable(){this.tableConfig={id:"CustomPages",tablename:"All Pages",columns:this.columns,rows:[],tools:[{name:"Search",id:"search",disabled:!1,icon:"assets/images/search.svg"},{name:"Filter",id:"filter",disabled:!1,icon:"assets/images/filter.svg",fields:[{type:"select",id:"role",label:"Role",controlname:"RoleId",placeholder:"Select Role",bindLabel:"Name",bindValue:"Id",validators:{required:!0},multiselect:!1,checkbox:!1,options:[],value:""}]},{name:"Column",id:"column",disabled:!1,icon:"assets/images/grid-columns.svg"},{name:"Export",id:"export",disabled:!1,icon:"assets/images/download.svg"}],totalRowsCount:0,pageCnt:0,showActions:!0,isPaginationRequired:!0,isColumnGroupRequired:!1,isFilterRequired:!1,isSearchRequired:!0}}onToolbarClick(e){switch(this.filterData={label:e.name,columns:this.tableConfig.columns,status:this.filterData?.status?this.filterData.status:null},this.filter=C(f({},this.filter),{PageNo:e.filter.pageNumber,PerPage:e.filter.pageSize,Search:e.filter.searchValue,SortBy:e.filter.sortBy,SortOrder:e.filter.sortOrder}),e.name){case g.SEARCH.NAME:this.filterData=C(f({},this.filterData),{status:e.filter.searchValue||e.filter.searchValue==""||e.filter.searchValue==null?null:this.filterData.status}),this.loadTableData(this.filter);break;case g.FILTER.NAME:break;case g.COLUMN.NAME:break;case g.EXPORT.NAME:this.filter=C(f({},this.filter),{PerPage:"all"});break;case g.PAGINATION.NAME:this.loadTableData(this.filter);break;case g.SORT.NAME:this.loadTableData(this.filter);break}}rowActions(e){let t={mode:e.operation,id:e.rowData.MenuId,label:e.rowData.Title,access:this.pageDetails.FullAccess};switch(e.operation){case c.EDIT.ID:this.changeRoute(this.portalUrl+_.BUILDER,t);break;case c.DUPLICATE.ID:this.duplicatePage(e.rowData.MenuId);break;case c.DELETE.ID:this.commonService.showModal("Delete",N.CUSTOMPAGES_DELETE_CONFIRMATION).afterClosed().subscribe(i=>{i&&this.deletePage(e.rowData.MenuId)});break}}onActionClick(e){}openDialog(e){}changeRoute(e,t){this.commonStoreService.setFormConfig(t),this.router.navigate([e])}createPage(){return I(this,null,function*(){let e={mode:m.CREATE};yield this.commonStoreService.setFormConfig(e),this.router.navigate([_.CREATE_CUSTOM_PAGE])})}duplicatePage(e){this.pageBuilderService.duplicatePage(e).subscribe({next:t=>{this.loadTableData(this.filter)},error:t=>{console.error("Error :: duplicating page:",t)}})}deletePage(e){this.pageBuilderService.deletePage(e).subscribe({next:t=>{this.loadTableData(this.filter)},error:t=>{}})}displayError(e){}static \u0275fac=function(t){return new(t||r)(n(R),n(x),n(k),n(L),n(O),n(U),n(w))};static \u0275cmp=D({type:r,selectors:[["app-manage-pages"]],decls:11,vars:4,consts:[[1,"rd-container"],[1,"rd-container-header"],[1,"rd-container-header-left"],[3,"url"],[1,"rd-heading","rd-heading-lg"],["class","rd-container-header-right",4,"ngIf"],[4,"ngIf"],[1,"rd-container-header-right"],["type","button",1,"rd-btn-primary","rd-btn-lg",3,"click"],[3,"filterChanged","rowClicked","getTableData","rowBasedAction","toolbarEvent","tableSettings","columns","data","totalCount"],["type","datatable"]],template:function(t,a){t&1&&(p(0,"div",0)(1,"div",1)(2,"div",2)(3,"div"),v(4,"back-button",3),s(),p(5,"div",4),P(6,"Custom pages"),s()(),y(7,z,4,0,"div",5),s(),p(8,"div"),y(9,H,2,4,"div",6)(10,X,2,0,"div",6),s()()),t&2&&(h(4),b("url",a.backUrl),h(3),b("ngIf",a.access),h(2),b("ngIf",a.pageDetails),h(),b("ngIf",!a.pageDetails))},dependencies:[V,M,A,F,B],encapsulation:2,changeDetection:0})};var G=class r{static \u0275fac=function(t){return new(t||r)};static \u0275cmp=D({type:r,selectors:[["app-dummy-listing"]],decls:1,vars:0,template:function(t,a){t&1&&v(0,"app-manage-pages")},dependencies:[S],encapsulation:2})};export{G as DummyListingComponent};
