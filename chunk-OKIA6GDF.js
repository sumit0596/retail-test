import{a as $}from"./chunk-B2JWDLBT.js";import{a as j}from"./chunk-FJTDMGYD.js";import{a as M}from"./chunk-F2AWUHRW.js";import{a as V}from"./chunk-6ZT7OVEF.js";import{a as q}from"./chunk-23ETMDCW.js";import"./chunk-FQU4EXR4.js";import{$ as L,ba as N}from"./chunk-FLJC444F.js";import{e as g,f as y,i as v,q as r}from"./chunk-IPZIKDLO.js";import{p as x}from"./chunk-TBJJFKUM.js";import{Fc as k,Gb as m,Qb as c,Rb as n,Sb as S,Wb as b,Yb as _,Z as h,Zb as d,a as E,ad as O,b as w,f as U,g as D,ib as s,jc as R,kd as A,m as T,nb as l,qa as u,ra as f,ub as I,zb as C}from"./chunk-4KZPWME3.js";var F=U(q());function P(i,e){if(i&1){let t=b();c(0,"div",7)(1,"button",8),_("click",function(){u(t);let a=d();return f(a.createRole())}),R(2," Create New Role "),n()()}}function Y(i,e){if(i&1){let t=b();c(0,"div")(1,"app-datatable",9),_("getTableData",function(a){u(t);let p=d();return f(p.tableData(a))})("rowBasedAction",function(a){u(t);let p=d();return f(p.rowActions(a))}),n()()}if(i&2){let t=d();s(),m("tableSettings",t.tableSettings)("columns",t.columns)("data",t.rows)("totalCount",t.totalCount)}}function G(i,e){i&1&&(c(0,"div"),S(1,"app-skeleton-loader",10),n())}var B=class i{constructor(e,t,o,a,p){this.router=e;this.commonStoreService=t;this.commonService=o;this.toasterService=a;this.cdr=p}rows=[];tableSettings;totalCount=0;access;formConfig;loadingSkeleton=!0;destroy$=new T;columns=[{key:"Name",title:"Name",sortable:!1,visible:!0,width:"25%"},{key:"Description",title:"Description",sortable:!1,visible:!0,width:"35%"},{key:"CreatedOn",title:"Date Created",sortable:!1,visible:!0,width:"20%"},{key:"actions",title:"Actions",sortable:!1,visible:!0,width:"20%"}];backUrl=g.ALL_USERS;ngOnInit(){this.getAllRoles()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}goBack(){}getAllRoles(){this.loadingSkeleton=!0,this.commonService.get(`${y.GET_ROLES}`).pipe(h(this.destroy$)).subscribe({next:e=>{this.rolesData(e),this.loadingSkeleton=!1},error:e=>{console.error(e),this.loadingSkeleton=!1}})}rolesData(e){e?.data?.roles&&(this.access=e.data.FullAccess,this.rows=e.data.roles.map(t=>w(E({},t),{CreatedOn:(0,F.default)(t.CreatedOn).format("DD/MM/YYYY"),operations:this.access===1?[{name:r.EDIT_OPERATION,icon:r.EDIT,operationName:r.EDIT,path:"assets/images/edit.svg"},{name:r.DELETE,icon:r.DELETE_ICON,operationName:r.DELETE,path:"assets/images/delete.svg"}]:[]})),this.totalCount=this.rows.length,this.tableSettings={id:"RoleId",tablename:"All Roles",rows:this.rows,columns:this.columns,isPaginationRequired:!1,isSearchRequired:!1,isFilterRequired:!1,isColumnGroupRequired:!1,isDownloadRequired:!1,showActions:!0,totalRowsCount:this.rows.length},this.cdr.markForCheck())}tableData(e){this.getAllRoles()}rowActions(e){return D(this,null,function*(){switch(this.formConfig={module:"role",operation:e.operation,id:e.rowData.RoleId},yield this.commonStoreService.setFormConfig(this.formConfig),e.operation){case v.VIEW:this.router.navigate([g.CREATE_ROLE]);break;case v.EDIT:this.router.navigate([g.EDIT_ROLE]);break;case v.DELETE:this.deleteRole(e.rowData.RoleId);break}})}createRole(){this.router.navigate(["/admin/manage-roles/create-role"])}deleteRole(e){let t=`${y.DELETE_ROLE}/${e}`;this.commonService.delete(t,e).pipe(h(this.destroy$)).subscribe({next:o=>{this.toasterService.success(o.message),this.getAllRoles()},error:o=>{}})}static \u0275fac=function(t){return new(t||i)(l(x),l(j),l(N),l(L),l(k))};static \u0275cmp=I({type:i,selectors:[["app-roles"]],decls:9,vars:4,consts:[[1,"rd-container"],[1,"rd-container-header"],[1,"rd-container-header-left"],[3,"url"],[1,"rd-heading","rd-heading-lg"],["class","rd-container-header-right",4,"ngIf"],[4,"ngIf"],[1,"rd-container-header-right"],["type","button",1,"rd-btn-primary","rd-btn-lg",3,"click"],[3,"getTableData","rowBasedAction","tableSettings","columns","data","totalCount"],["type","datatable"]],template:function(t,o){t&1&&(c(0,"div",0)(1,"div",1)(2,"div",2),S(3,"back-button",3),c(4,"div",4),R(5,"Roles"),n()(),C(6,P,3,0,"div",5),n(),C(7,Y,2,4,"div",6)(8,G,2,0,"div",6),n()),t&2&&(s(3),m("url",o.backUrl),s(3),m("ngIf",o.access===1),s(),m("ngIf",!o.loadingSkeleton&&(o.tableSettings==null||o.tableSettings.rows==null?null:o.tableSettings.rows.length)),s(),m("ngIf",o.loadingSkeleton&&!(!(o.tableSettings==null||o.tableSettings.rows==null)&&o.tableSettings.rows.length)))},dependencies:[A,O,$,M,V],encapsulation:2})};export{B as RolesComponent};
